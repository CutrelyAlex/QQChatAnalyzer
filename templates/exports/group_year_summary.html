<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ç¾¤èŠå¹´åº¦æ€»ç»“</title>
  <style>
    :root{
      --bg:#0b1020;
      --fg:#eaf0ff;
      --muted:rgba(234,240,255,.75);
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.08);
      --line:rgba(255,255,255,.12);
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --warn:#ffcc66;
    }
    *{box-sizing:border-box;}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"PingFang SC","Microsoft YaHei",sans-serif;background:radial-gradient(1200px 600px at 20% 0%, rgba(110,231,255,.18), transparent 60%),radial-gradient(900px 500px at 80% 20%, rgba(167,139,250,.18), transparent 60%),var(--bg);color:var(--fg);}
    a{color:inherit;}

    .page{width:min(980px, 94vw);margin:28px auto;padding:26px 26px 22px;border:1px solid var(--line);background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));border-radius:18px;box-shadow:0 20px 60px rgba(0,0,0,.35);position:relative;overflow:hidden;}
    .page:before{content:"";position:absolute;inset:-2px;background:linear-gradient(90deg, rgba(110,231,255,.18), rgba(167,139,250,.18), rgba(110,231,255,.18));filter:blur(16px);opacity:.65;z-index:0;}
    .page > *{position:relative;z-index:1;}

    .header{display:flex;gap:14px;align-items:flex-end;justify-content:space-between;margin-bottom:16px;}
    .title{font-size:26px;font-weight:800;letter-spacing:.5px;}
    .meta{font-size:12px;color:var(--muted);text-align:right;line-height:1.6;}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:rgba(0,0,0,.18);font-size:12px;color:var(--muted);}

    .grid{display:grid;grid-template-columns:repeat(12, 1fr);gap:12px;}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:14px;}
    .card h3{margin:0 0 8px 0;font-size:14px;letter-spacing:.3px;color:rgba(234,240,255,.92)}
    .kpi{font-size:22px;font-weight:800;}
    .kpi-sub{font-size:12px;color:var(--muted);margin-top:4px;}

    .chip{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;background:rgba(110,231,255,.10);border:1px solid rgba(110,231,255,.25);}
    .chip .w{font-weight:800;}
    .chip .c{font-size:12px;color:var(--muted);}

    .word-block{border:1px solid var(--line);border-radius:14px;background:var(--card2);padding:14px;}
    .word-head{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-bottom:10px;}
    .word-title{display:flex;flex-wrap:wrap;gap:10px;align-items:baseline;}
    .word-title .word{font-size:20px;font-weight:900;}
    .word-title .count{font-size:12px;color:var(--muted)}

    .examples{margin:0;padding-left:18px;color:rgba(234,240,255,.9)}
    .examples li{margin:6px 0;line-height:1.55;}
    .examples .who{color:var(--muted);font-size:12px;}
    .examples .txt{color:rgba(234,240,255,.95);}

    .rank{display:flex;flex-direction:column;gap:8px;}
    .rank-row{display:grid;grid-template-columns:42px 1fr auto;gap:10px;align-items:center;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:rgba(0,0,0,.12)}
    .rank-row .no{font-weight:900;color:rgba(110,231,255,.9)}
    .rank-row .name{font-weight:700;}
    .rank-row .count{color:var(--muted);font-variant-numeric:tabular-nums;}

    .hint{color:var(--muted);font-size:12px;line-height:1.6;}

    @media print{
      body{background:#fff;color:#000;}
      .page{box-shadow:none;background:#fff;border-color:#ddd;}
      .page:before{display:none;}
      .card,.word-block{background:#fff;border-color:#ddd;}
      .meta,.hint,.kpi-sub,.chip .c,.word-title .count,.examples .who,.rank-row .count{color:#333;}
      .page{break-after:page;}
    }
  </style>
</head>
<body>

  <!-- å°é¢ / æ¦‚è§ˆ -->
  <section class="page">
    <div class="header">
      <div>
        <div class="title">ç¾¤èŠå¹´åº¦æ€»ç»“</div>
        <div class="badge">ğŸ“ {{ filename }}</div>
      </div>
      <div class="meta">
        <div>ç”Ÿæˆæ—¶é—´ï¼š{{ generated_at }}</div>
        <div class="hint">æç¤ºï¼šä¾‹å¥åŸºäºâ€œçƒ­è¯åŒ…å«â€åŒ¹é…ï¼›å¦‚éœ€æ›´ä¸¥è°¨çš„è¯­ä¹‰åŒ¹é…å¯åç»­å‡çº§ã€‚</div>
      </div>
    </div>

    <div class="grid">
      <div class="card" style="grid-column: span 4;">
        <h3>æ¶ˆæ¯æ€»æ•°</h3>
        <div class="kpi">{{ group_stats.total_messages or '-' }}</div>
        <div class="kpi-sub">åˆ†æå£å¾„ï¼šå¯¼å…¥åçš„æœ‰æ•ˆæ¶ˆæ¯</div>
      </div>

      <div class="card" style="grid-column: span 4;">
        <h3>æ—¥å‡æ¶ˆæ¯</h3>
        <div class="kpi">{{ group_stats.daily_average or '-' }}</div>
        <div class="kpi-sub">å…¨å¹´å¹³å‡ï¼ˆæŒ‰è®°å½•è¦†ç›–å¤©æ•°ä¼°ç®—ï¼‰</div>
      </div>

      <div class="card" style="grid-column: span 4;">
        <h3>æœ€æ´»è·ƒæ—¶æ®µ</h3>
        <div class="kpi">{% if group_stats.peak_hour is not none %}{{ group_stats.peak_hour }}:00{% else %}-{% endif %}</div>
        <div class="kpi-sub">å³°å€¼å°æ—¶ï¼ˆæŒ‰å°æ—¶èšåˆï¼‰</div>
      </div>

      <div class="card" style="grid-column: span 6;">
        <h3>ç»“æ„åŒ–æ¶ˆæ¯</h3>
        <div class="hint">
          ç³»ç»Ÿï¼š{{ group_stats.system_messages or 0 }} ï½œ æ’¤å›ï¼š{{ group_stats.recalled_messages or 0 }} ï½œ å«@ï¼š{{ group_stats.mention_messages or 0 }} ï½œ å›å¤ï¼š{{ group_stats.reply_messages or 0 }} ï½œ åª’ä½“/é™„ä»¶ï¼š{{ group_stats.media_messages or 0 }}
        </div>
      </div>

      <div class="card" style="grid-column: span 6;">
        <h3>æˆå‘˜è§„æ¨¡</h3>
        <div class="hint">æ€»æˆå‘˜ï¼š{{ group_stats.total_members or '-' }} ï½œ Top5 å‘è¨€æ¦œè§åé¡µ</div>
      </div>
    </div>
  </section>

  <!-- çƒ­è¯é¡µï¼š4 é¡µï¼Œæ¯é¡µ 2 ä¸ªçƒ­è¯ -->
  {% for p in hotword_pages %}
  <section class="page">
    <div class="header">
      <div>
        <div class="title">å¹´åº¦çƒ­è¯ Â· ç¬¬ {{ p.index }} / {{ hotword_pages|length }} é¡µ</div>
        <div class="hint">æ¯é¡µ 2 ä¸ªçƒ­è¯ï¼Œæ¯ä¸ªçƒ­è¯å±•ç¤º â‰¥5 æ¡ï¼ˆè‹¥æ–‡æœ¬ä¸­ä¸è¶³åˆ™æ˜¾ç¤ºå®é™…å¯åŒ¹é…æ¡æ•°ï¼‰</div>
      </div>
      <div class="meta">æ¥æºï¼šç¾¤ä½“åˆ†æçƒ­è¯ + åŸæ–‡ä¾‹å¥</div>
    </div>

    <div class="grid">
      {% for w in p.words %}
      <div class="word-block" style="grid-column: span 12;">
        <div class="word-head">
          <div class="word-title">
            <span class="word">{{ w.word }}</span>
            <span class="count">å‡ºç° {{ w.count }} æ¬¡ï¼ˆçƒ­è¯æ¦œå£å¾„ï¼‰</span>
          </div>
          <div class="chip"><span class="w">ä¾‹å¥</span><span class="c">{{ (w.examples|length) }} æ¡</span></div>
        </div>

        {% if w.examples and w.examples|length > 0 %}
        <ol class="examples">
          {% for ex in w.examples %}
          <li>
            <div class="txt">{{ ex.content }}</div>
            <div class="who">{{ ex.timestamp }} Â· {{ ex.sender }}{% if ex.qq %} ({{ ex.qq }}){% endif %}</div>
          </li>
          {% endfor %}
        </ol>
        {% else %}
          <div class="hint">æœªæ‰¾åˆ°åŒ…å«è¯¥çƒ­è¯çš„æ–‡æœ¬æ¶ˆæ¯ï¼ˆå¯èƒ½è¯¥çƒ­è¯ä¸»è¦æ¥è‡ªåˆ‡è¯/å½’ä¸€åŒ–å·®å¼‚ï¼‰ã€‚</div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  </section>
  {% endfor %}

  <!-- æ¦œå•é¡µ -->
  <section class="page">
    <div class="header">
      <div>
        <div class="title">ç¾¤èŠå…³é”®æ¦œå•</div>
        <div class="hint">ä¸€çœ¼çœ‹æ‡‚â€œè°æœ€èƒ½èŠã€è°æœ€ä¼š@ã€è°æœ€å¤œçŒ«å­/æ—©èµ·é¸Ÿï¼ˆè¿‘ä¼¼ï¼‰â€</div>
      </div>
      <div class="meta">æ•°æ®æºï¼šç¾¤ä½“åˆ†æç¼“å­˜ï¼ˆgroupï¼‰</div>
    </div>

    <div class="grid">
      <div class="card" style="grid-column: span 12;">
        <h3>Top 5 å‘è¨€</h3>
        {% if top_speakers and top_speakers|length > 0 %}
        <div class="rank">
          {% for u in top_speakers %}
          <div class="rank-row">
            <div class="no">#{{ loop.index }}</div>
            <div class="name">{{ u.name }}{% if u.qq %} ({{ u.qq }}){% endif %}</div>
            <div class="count">{{ u.count }} æ¡</div>
          </div>
          {% endfor %}
        </div>
        {% else %}
          <div class="hint">æš‚æ— æˆå‘˜å‘è¨€ç»Ÿè®¡æ•°æ®</div>
        {% endif %}
      </div>

      <div class="card" style="grid-column: span 6;">
        <h3>ç†¬å¤œæœ€å¤šï¼ˆè¿‘ä¼¼ï¼‰</h3>
        {% if top_night_owl %}
          <div class="kpi">{{ top_night_owl.name or top_night_owl.qq or '-' }}</div>
          <div class="kpi-sub">åœ¨ {{ top_night_owl.hour }} ç‚¹çš„â€œå°æ—¶å† å†›â€é‡Œè®¡æ•°æœ€é«˜ï¼ˆ{{ top_night_owl.count }} æ¡ï¼‰</div>
        {% else %}
          <div class="hint">ç¼ºå°‘å‡Œæ™¨æ—¶æ®µç»Ÿè®¡</div>
        {% endif %}
      </div>

      <div class="card" style="grid-column: span 6;">
        <h3>æ—©èµ·æœ€å¤šï¼ˆè¿‘ä¼¼ï¼‰</h3>
        {% if top_early_bird %}
          <div class="kpi">{{ top_early_bird.name or top_early_bird.qq or '-' }}</div>
          <div class="kpi-sub">åœ¨ {{ top_early_bird.hour }} ç‚¹çš„â€œå°æ—¶å† å†›â€é‡Œè®¡æ•°æœ€é«˜ï¼ˆ{{ top_early_bird.count }} æ¡ï¼‰</div>
        {% else %}
          <div class="hint">ç¼ºå°‘æ¸…æ™¨æ—¶æ®µç»Ÿè®¡</div>
        {% endif %}
      </div>

      <div class="card" style="grid-column: span 12;">
        <h3>@ ä»–äººæœ€å¤š</h3>
        {% if top_mention_sender %}
          <div class="hint">{{ top_mention_sender.name or top_mention_sender.qq or '-' }}{% if top_mention_sender.qq %} ({{ top_mention_sender.qq }}){% endif %} Â· {{ top_mention_sender.count or 0 }} æ¡å«@æ¶ˆæ¯</div>
        {% else %}
          <div class="hint">æš‚æ—  @ ç»Ÿè®¡æ•°æ®</div>
        {% endif %}
      </div>

      <div class="card" style="grid-column: span 12;">
        <h3>å¤‡æ³¨</h3>
        <div class="hint">
          - â€œç†¬å¤œ/æ—©èµ·æœ€å¤šâ€å½“å‰é‡‡ç”¨ <b>æ¯å°æ—¶æœ€æ´»è·ƒç”¨æˆ·</b> çš„ç»Ÿè®¡åšè¿‘ä¼¼ï¼›è‹¥éœ€è¦ä¸¥æ ¼å£å¾„ï¼ˆæŒ‰ç”¨æˆ·åœ¨æ—¶æ®µå†…çš„æ€»å‘è¨€æ•°ï¼‰ï¼Œå»ºè®®åœ¨ç¾¤ä½“åˆ†æç¼“å­˜é‡Œå¢åŠ â€œç”¨æˆ·Ã—å°æ—¶â€çš„åˆ†å¸ƒçŸ©é˜µã€‚
          <br>
          - è‹¥ä½ å¸Œæœ›å¯¼å‡º PNGï¼Œå¯åœ¨æ­¤ HTML åŸºç¡€ä¸Šæ¥å…¥æµè§ˆå™¨æˆªå›¾ï¼ˆä¾‹å¦‚ Playwrightï¼‰å®ç°ä¸€é”®æ¸²æŸ“ã€‚
        </div>
      </div>
    </div>
  </section>

</body>
</html>
